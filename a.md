# PDF 結合アプリ 仕様書

## 1. 概要

本アプリは、複数の PDF ファイルを任意の順番で結合し、1 つの PDF として出力する簡易ツールである。最小構成で動作し、特定のフレームワークや言語に依存しない方針とする。実装は後で Codex に任せるため、本仕様書は処理内容を明確に定義することを目的とする。

---

## 2. 目的

* 複数 PDF を結合する作業の効率化
* Web ブラウザ上で完結する操作性の提供
* 言語に依存しないロジック仕様の明確化
* Codex による自動コード生成がしやすい構造にする

---

## 3. 対象ユーザー

* 社内で簡単に PDF を結合したいユーザー
* ローカルでアプリを動かしたいエンジニア
* Web から PDF を結合したい一般利用者

---

## 4. 機能一覧

### 4.1 メイン機能

* PDF ファイルの複数選択
* 選択した PDF ファイルの並び替え（上・下・削除）
* 結合実行
* 結合後の PDF ダウンロード

### 4.2 サブ機能

* 出力ファイル名の指定
* ファイルサイズ制限（任意、後述）

---

## 5. 動作フロー

1. ユーザーがブラウザ上で PDF ファイルを複数選択
2. 選択されたファイルがリスト化され、ユーザーは順番を調整できる
3. 結合ボタン押下
4. サーバー側でファイルを順番通り読込み、結合
5. 結合された PDF を生成
6. ユーザーにダウンロード提供

---

## 6. 入出力仕様

### 6.1 入力

| 項目         | 内容              |
| ---------- | --------------- |
| `pdfs[]`   | 複数 PDF ファイル（必須） |
| `filename` | 出力ファイル名（任意）     |

### 6.2 出力

| 項目       | 内容                                     |
| -------- | -------------------------------------- |
| PDF ファイル | 結合後 PDF（Content-Type: application/pdf） |
| ステータスコード | 成功時: 200 / 失敗時: 400 or 500             |

---

## 7. API 仕様（言語非依存）

### 7.1 エンドポイント

```
POST /merge
```

### 7.2 リクエスト形式

```
multipart/form-data
```

### 7.3 レスポンス

* 成功時: 結合済み PDF を返却
* 失敗時: エラーメッセージを JSON で返却

### 7.4 エラー例

| ステータス | 条件      | メッセージ例            |
| ----- | ------- | ----------------- |
| 400   | PDF 未選択 | "PDF を選択してください"   |
| 500   | 内部エラー   | "PDF 結合処理に失敗しました" |

---

## 8. PDF 結合ロジック仕様

### 8.1 結合手順

1. 入力された PDF ファイルリストを順番通り処理
2. 各 PDF をページ単位で読み込み、新規 PDF に追記
3. 全ページ結合後、 1つの PDF として出力

### 8.2 ファイル制限（任意）

| 項目      | 内容              |
| ------- | --------------- |
| 最大ファイル数 | 10 〜 20（必要なら設定） |
| 最大サイズ   | 合計 20MB（必要なら設定） |

---

## 9. UI の仕様

### 9.1 画面構成

* PDF アップロードフォーム
* 選択ファイル一覧（順番変更ボタン付き）
* 出力ファイル名入力欄
* 結合ボタン
* エラー表示領域

### 9.2 操作イメージ

```
[PDFを選択] [ドラッグ&ドロップ対応]

1. fileA.pdf   ▲ ▼ ✕
2. fileB.pdf   ▲ ▼ ✕
3. fileC.pdf   ▲ ▼ ✕

[出力ファイル名] merged.pdf

[結合する]
```

---

## 10. セキュリティ仕様

* アップロードされたファイルはサーバー側で一時保存後、結合後に破棄
* 外部にファイルが漏れない構成
* 最大サイズ制限で DoS 回避（任意）

---

## 11. 想定ディレクトリ構造（言語非依存）

```
project/
│
├─ app/        # サーバーロジック（API）
├─ static/     # CSS/JS
├─ templates/  # HTML
└─ README.md
```

---

## 12. 非機能要件

| 項目      | 内容                           |
| ------- | ---------------------------- |
| パフォーマンス | 10 ファイル程度の結合に 1 秒以内（環境により変動） |
| 可搬性     | Docker 化可能な構成                |
| 保守性     | Codex で自動生成しやすいレベルまで簡素化      |

---

## 13. 今後の拡張案

* PDF の分割機能
* サムネイル生成
* 順番をドラッグで変更できる UI
* 履歴管理（社内向けの場合）

---

## 14. まとめ

本仕様書は、Codex を用いて自動生成しやすいよう、実装方式ではなくロジックと処理仕様に重点を置いている。最小構成で動く PDF 結合アプリとして明確に要件定義されており、実装は任意の言語で可能である。
